<ui:component xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html"
	xmlns:cc="http://java.sun.com/jsf/composite" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions" xmlns:p="http://primefaces.org/ui"
>
	<cc:interface>
		<cc:attribute name="userCC" type="pw.mario.faces.api.UserList" required="true" />
	</cc:interface>
	<cc:implementation>
		<h:form>
			<p:panel id="tUserTable" header="#{ccRes.tUsersTittle}">
				<p:dataTable id="dtUserList" resizableColumns="true" var="u" value="#{cc.attrs.userCC.users}" border="1" rows="10" paginator="true"
					paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					rowsPerPageTemplate="10, 20, 30" lazy="true" sortMode="multiple" expandedRow="false" reflow="true" rendered="true" selectionMode="single"
					selection="#{cc.attrs.userCC.selectedUser}" rowKey="#{u.id}" editable="true"
				>
					<p:ajax event="rowSelect" listener="#{cc.attrs.userCC.onRowSelect}" />
					<p:ajax event="rowUnselect" listener="#{cc.attrs.userCC.onRowUnselect}" />
					<p:ajax event="rowEdit" listener="#{cc.attrs.userCC.onUserEdit}"/>
					
					<p:column id="cLogin" resizable="true" sortBy="#{u.login}">
						<f:facet name="header">#{ccRes.cUserLogin}</f:facet>
						<h:outputText value="#{u.login}" />
					</p:column>
					<p:column id="cName" resizable="true" sortBy="#{u.name}">
						<f:facet name="header">#{ccRes.cUserName}</f:facet>
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{u.name}" />
							</f:facet>
							<f:facet name="input">
								<p:inputText value="#{u.name}" />
							</f:facet>
						</p:cellEditor>
					</p:column>
					<p:column id="cSecondName" resizable="true" sortBy="#{u.secondName}">
						<f:facet name="header">#{ccRes.cSecondName}</f:facet>
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{u.secondName}" />
							</f:facet>
							<f:facet name="input">
								<p:inputText value="#{u.secondName}" />
							</f:facet>
						</p:cellEditor>
					</p:column>
					<p:column id="cEmail" resizable="true" sortBy="#{u.email}">
						<f:facet name="header">#{ccRes.cUserEmail}</f:facet>
						<h:outputText value="#{u.email}" />
					</p:column>
					<p:column id="cDepartment" resizable="true" sortBy="#{u.dept}">
						<f:facet name="header">#{ccRes.cUserDepartment}</f:facet>
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{not empty  u.dept ? u.dept.deptCode : null}" />
							</f:facet>
							<f:facet name="input">
								<p:selectOneMenu id="userEditDept" value="#{u.dept}" converter="#{deptConverter}" effect="fade">
									<f:selectItem itemLabel="" itemValue="" />
									<f:selectItems value="#{cc.attrs.userCC.departments}" var="dept" itemLabel="#{dept.deptCode}" itemValue="#{dept}" />
									<p:column>
										<h:outputText value="#{dept.deptCode}" />
									</p:column>
									<p:column>
										<h:outputText value="#{dept.fullName}" />
									</p:column>
								</p:selectOneMenu>
							</f:facet>
						</p:cellEditor>
					</p:column>
					<p:column style="width:16px">
						<p:rowToggler />
					</p:column >
					<p:column style="width:16px">
						<p:rowEditor />
					</p:column>
					<p:rowExpansion>
						<p:dataList value="#{u.systemRoles}" var="sr" rows="10" type="ordered" paginator="true" itemType="none" emptyMessage="#{ccRes.dlNoneRoles}"
							paginatorAlwaysVisible="false"
						>
							<f:facet name="header">#{ccRes.hUserSystemRoles}</f:facet>
							<h:outputText value="#{sr.roleName}" style="display:inline-block" />
						</p:dataList>
					</p:rowExpansion>
				</p:dataTable>
			</p:panel>
		</h:form>
	</cc:implementation>
</ui:component>